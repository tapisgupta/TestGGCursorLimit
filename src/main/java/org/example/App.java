package org.example;
import org.apache.ignite.Ignition;
import org.apache.ignite.client.IgniteClient;
import org.apache.ignite.configuration.ClientConfiguration;
import java.util.Date;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

/**
 * Main Class
 *
 */
public class App 
{
    public static void main( String[] args ) throws Exception {
        long time = new Date().getTime();
        int id = 192;
        ClientConfiguration cfg = new ClientConfiguration().setAddresses("10.80.0.51:31800");
        String str[] = {"4917412462273 0 ","4917412869390 0 ","4917411556516 0 ","7774917412941459 1 ","7774917412990094 1 ","7774917412279289 1 ","4917412053123 0 ","7774917412075714 1 ","7774917410692936 1 ","4917410432004 0 ","7774917412110254 1 ","4917412395212 0 ","7774917410002615 1 ","4917410670329 0 ","4917412092413 0 ","7774917411378317 1 ","4917411369853 0 ","4917411991921 0 ","7774917412906939 1 ","7774917411576315 1 ","7774917412157124 1 ","7774917411156770 1 ","4917412103561 0 ","4917411512610 0 ","4917412533341 0 ","4917412450967 0 ","7774917412019497 1 ","7774917410937406 1 ","4917412100899 0 ","7774917412170495 1 ","4917411101508 0 ","4917412523806 0 ","7774917411956320 1 ","4917411323816 0 ","7774917412369013 1 ","7774917411303581 1 ","4917411705623 0 ","7774917410316280 1 ","7774917412023923 1 ","7774917411895681 1 ","7774917410249530 1 ","7774917411228761 1 ","4917410449311 0 ","4917411773912 0 ","7774917411208518 1 ","4917410832857 0 ","4917411089131 0 ","4917410417641 0 ","7774917412908234 1 ","7774917411217370 1 ","7774917412266288 1 ","7774917412947103 1 ","7774917410513839 1 ","7774917411608465 1 ","7774917410419400 1 ","7774917412092150 1 ","7774917410503236 1 ","7774917411439563 1 ","7774917411532460 1 ","4917411829420 0 ","4917410559636 0 ","7774917411545322 1 ","4917410861580 0 ","7774917411636467 1 ","7774917411652500 1 ","7774917411266130 1 ","4917411874213 0 ","4917411280805 0 ","4917410799625 0 ","4917410313524 0 ","4917411627204 0 ","7774917411203814 1 ","7774917412389380 1 ","4917410162750 0 ","4917412608303 0 ","7774917411672345 1 ","4917410726876 0 ","4917412733913 0 ","7774917410730495 1 ","4917412090152 0 ","4917410920752 0 ","7774917412127838 1 ","7774917410515896 1 ","7774917411153137 1 ","7774917411866266 1 ","7774917412092576 1 ","4917412499887 0 ","7774917412651588 1 ","7774917412008594 1 ","7774917411794084 1 ","7774917412535258 1 ","4917412884375 0 ","7774917411106277 1 ","7774917411355241 1 ","4917412975366 0 ","7774917410624203 1 ","7774917410201865 1 ","7774917411645593 1 ","7774917412099495 1 ","7774917410691025 1 ","4917412477648 0 ","4917412856655 0 ","4917411823235 0 ","4917412054013 0 ","4917411112079 0 ","7774917411572224 1 ","4917411895941 0 ","7774917410231119 1 ","7774917411729290 1 ","7774917410313898 1 ","7774917410425986 1 ","7774917411207718 1 ","7774917411871604 1 ","4917410437003 0 ","4917412777466 0 ","4917412361239 0 ","7774917410907403 1 ","7774917412809401 1 ","7774917410026769 1 ","7774917410474726 1 ","4917410326149 0 ","7774917412223156 1 ","4917412842367 0 ","7774917411200104 1 ","4917410515895 0 ","4917411024981 0 ","4917412440389 0 ","4917412722647 0 ","7774917410403551 1 ","4917412436613 0 ","7774917410023042 1 ","4917412939058 0 ","4917412075239 0 ","4917411202488 0 ","7774917410903809 1 ","4917410609194 0 ","4917410546536 0 ","4917411467184 0 ","7774917412268262 1 ","7774917410236985 1 ","4917412668057 0 ","4917410926155 0 ","4917410638553 0 ","4917412921400 0 ","4917410491654 0 ","7774917412892380 1 ","4917410246600 0 ","7774917412123155 1 ","4917411684899 0 ","7774917412368317 1 ","7774917412192461 1 ","4917411723476 0 ","7774917410993410 1 ","4917412001829 0 ","4917412519311 0 ","7774917412507126 1 ","7774917410231286 1 ","7774917412982217 1 ","7774917412209938 1 ","4917411320500 0 ","4917412959434 0 ","4917411743430 0 ","4917412201284 0 ","4917412373038 0 ","7774917412800594 1 ","7774917411636904 1 ","7774917410252604 1 ","7774917410135235 1 ","7774917411088973 1 ","7774917410483952 1 ","7774917410135892 1 ","7774917412262850 1 ","7774917412033554 1 ","7774917412468491 1 ","4917411779579 0 ","7774917411219110 1 ","4917411585769 0 ","7774917412379369 1 ","7774917412499990 1 ","4917412408227 0 ","4917412593049 0 ","4917412014650 0 ","7774917411412435 1 ","4917410300681 0 ","7774917411999156 1 ","4917410135734 0 ","7774917411629161 1 ","7774917411899413 1 ","4917412082351 0 ","4917412486466 0 ","4917412723848 0 ","4917411485711 0 ","7774917412221901 1 ","4917412173094 0 ","7774917412232212 1 ","4917411970917 0 ","7774917410273068 1 ","7774917412882721 1 ","7774917412386772 1 ","7774917410614421 1 ","7774917412081613 1 ","7774917410563935 1 ","7774917411084643 1 ","7774917410227330 1 ","4917412465153 0 ","4917410866065 0 ","4917412802037 0 ","7774917410251721 1 ","7774917412220652 1 ","7774917412382539 1 ","7774917412797583 1 ","7774917412239621 1 ","7774917411427927 1 ","7774917410098831 1 ","7774917411479094 1 ","7774917412484634 1 ","7774917412871526 1 ","4917412302248 0 ","7774917411098019 1 ","7774917412972065 1 ","7774917410319498 1 ","7774917410537405 1 ","4917410623717 0 ","4917410680488 0 ","7774917412769649 1 ","4917412433251 0 ","7774917410117447 1 ","4917410670015 0 ","7774917410247386 1 ","4917411490891 0 ","7774917410238550 1 ","7774917412732607 1 ","7774917412664831 1 ","4917410955895 0 ","4917410920320 0 ","4917411917746 0 ","4917410346615 0 ","7774917411016488 1 ","4917412543552 0 ","7774917411870748 1 ","4917412742451 0 ","4917412478104 0 ","7774917410664455 1 ","4917410444091 0 ","7774917410222289 1 ","4917410396739 0 ","7774917411782406 1 ","7774917411032049 1 ","4917410920815 0 ","4917411199845 0 ","7774917411309071 1 ","7774917412798227 1 ","7774917410296006 1 ","4917411446840 0 ","7774917411698535 1 ","7774917410489282 1 ","7774917412168243 1 ","4917411211825 0 ","4917411073847 0 ","4917412345736 0 ","4917411404372 0 ","4917410657810 0 ","7774917412894908 1 ","4917411707845 0 ","4917411288136 0 ","4917411270667 0 ","7774917410712438 1 ","7774917411120168 1 ","7774917410992651 1 ","4917412158883 0 ","4917410763899 0 ","4917411677968 0 ","7774917411116062 1 ","4917411422753 0 ","4917411100905 0 ","4917411138925 0 ","7774917410037378 1 ","4917412700293 0 ","4917411083177 0 ","7774917410972246 1 ","4917412750618 0 ","7774917412859250 1 ","4917412946597 0 ","7774917410373495 1 ","7774917410068128 1 ","7774917411751477 1 ","7774917412330225 1 ","4917410763932 0 ","4917410579750 0 ","7774917411440930 1 ","4917410816178 0 ","4917411150732 0 ","4917410674174 0 ","7774917412478867 1 ","7774917411089976 1 ","4917410948208 0 ","4917412950157 0 ","4917412223681 0 ","7774917412328016 1 ","4917412761492 0 ","4917412956179 0 ","4917412453354 0 ","7774917411274917 1 ","7774917412091108 1 ","7774917412279012 1 ","4917412587653 0 ","4917412684804 0 ","4917410772406 0 ","7774917412892624 1 ","7774917412674892 1 ","4917412164403 0 ","4917410608529 0 ","4917411226485 0 ","4917410158786 0 ","7774917412687456 1 ","7774917412820968 1 ","4917411030578 0 ","4917410513538 0 ","7774917410289105 1 ","7774917412098479 1 ","4917411883709 0 ","7774917411219259 1 ","4917410615197 0 ","7774917410918862 1 ","7774917411053717 1 ","7774917410139029 1 ","4917412097370 0 ","4917410442106 0 ","4917411863869 0 ","4917412691123 0 ","7774917412809001 1 ","4917412554723 0 ","4917410490536 0 ","7774917410448428 1 ","4917412875709 0 ","4917412480654 0 ","7774917411521756 1 ","7774917410887116 1 ","7774917411813063 1 ","7774917410074977 1 ","7774917412426581 1 ","4917411642778 0 ","7774917410151251 1 ","7774917411462866 1 ","4917412937854 0 ","7774917412617074 1 ","7774917411101886 1 ","7774917411010193 1 ","7774917412239121 1 ","4917411068220 0 ","7774917410721106 1 ","4917410649571 0 ","4917412695958 0 ","7774917410378938 1 ","7774917411514985 1 ","4917411171221 0 ","4917412479010 0 ","7774917412166898 1 ","7774917411083326 1 ","7774917411512931 1 ","4917410830258 0 ","4917412155502 0 ","4917411538959 0 ","4917412562127 0 ","7774917410004735 1 ","4917412462019 0 ","7774917412053814 1 ","4917410458849 0 ","4917412320277 0 ","7774917412063907 1 ","4917412377203 0 ","7774917412514917 1 ","4917410748989 0 ","7774917411750225 1 ","4917410683932 0 ","4917412818123 0 ","7774917411837793 1 ","7774917412496993 1 ","7774917412610300 1 ","4917410125283 0 ","7774917410232054 1 ","4917412393206 0 ","7774917410585878 1 ","4917410452611 0 ","7774917412821819 1 ","4917412639515 0 ","4917410053335 0 ","7774917410491707 1 ","7774917411758668 1 ","4917412593668 0 ","4917411825715 0 ","4917410740475 0 ","7774917410747708 1 ","4917411864701 0 ","7774917412024762 1 ","7774917411384623 1 ","7774917410941376 1 ","4917411089147 0 ","7774917411208405 1 ","7774917411844434 1 ","7774917412916687 1 ","4917412867274 0 ","4917410504087 0 ","7774917412725351 1 ","7774917412404831 1 ","4917411085283 0 ","7774917411894825 1 ","7774917411557500 1 ","4917410493054 0 ","4917412848164 0 ","4917412075213 0 ","4917410845917 0 ","4917411232603 0 ","4917410532767 0 ","7774917411754332 1 ","4917410457732 0 ","4917412626283 0 ","4917411297192 0 ","7774917410524362 1 ","4917410818899 0 ","7774917410383774 1 ","7774917411303883 1 ","4917412743993 0 ","4917412206168 0 ","4917410917652 0 ","7774917411848325 1 ","4917412063957 0 ","4917410268088 0 ","7774917411426000 1 ","7774917410744624 1 ","4917410686163 0 ","4917411083520 0 ","4917412632037 0 ","4917410769389 0 ","7774917410443495 1 ","7774917411266460 1 ","4917410990815 0 ","4917411516366 0 ","7774917410147320 1 ","4917412079085 0 ","4917412218220 0 ","7774917411583391 1 ","4917411011105 0 ","7774917411816067 1 ","7774917412952939 1 ","7774917411023532 1 ","4917411589754 0 ","7774917410251270 1 ","4917411099425 0 ","7774917412601676 1 ","4917411483091 0 ","4917411209636 0 ","4917411473782 0 ","7774917411254376 1 ","4917411930909 0 ","4917412579707 0 ","4917412529096 0 ","4917410230660 0 ","4917410215015 0 ","7774917410845174 1 ","7774917412011045 1 ","7774917410682207 1 ","4917410597583 0 ","7774917412058659 1 ","7774917412507432 1 ","7774917412869799 1 ","7774917410873173 1 ","4917412237931 0 ","4917411846563 0 ","7774917412188927 1 ","4917410454311 0 ","4917411267363 0 ","7774917410750286 1 ","7774917411289776 1 ","7774917411651849 1 ","7774917412444739 1 ","7774917412006108 1 ","4917411633191 0 ","7774917412307168 1 ","4917410371189 0 ","7774917411744102 1 ","4917412505603 0 ","7774917412730776 1 ","7774917410427815 1 ","7774917410897330 1 ","7774917411424046 1 ","4917412042585 0 ","7774917411839205 1 ","7774917411770465 1 ","4917410534686 0 ","4917410019795 0 ","4917410109521 0 ","4917411939427 0 ","4917410742920 0 ","4917411646136 0 ","4917410913945 0 ","4917410268911 0 ","7774917410057866 1 ","7774917412502792 1 ","7774917412861910 1 ","4917412650253 0 ","4917411215056 0 ","4917411624237 0 ","4917411481727 0 ","4917410705942 0 ","4917412796966 0 ","4917412004147 0 ","7774917412700168 1 ","7774917412882231 1 ","4917410288898 0 ","4917412415316 0 ","7774917411729342 1 ","7774917412208972 1 ","7774917410882117 1 ","4917411554069 0 ","4917412068081 0 ","4917410867604 0 ","7774917411702893 1 ","7774917411297961 1 ","7774917412050561 1 ","7774917411209416 1 ","4917412443577 0 ","4917412540597 0 ","7774917410730802 1 ","7774917411912154 1 ","7774917411603205 1 ","4917410676191 0 ","7774917412196196 1 ","4917410761414 0 ","7774917411348090 1 ","7774917410462490 1 ","4917410249076 0 ","4917411005402 0 ","4917410236036 0 ","4917410924234 0 ","7774917412262605 1 ","7774917410209489 1 ","7774917412655792 1 ","7774917411650150 1 ","7774917410617724 1 ","4917410191650 0 ","4917411920618 0 ","7774917412067477 1 ","4917411396862 0 ","4917410288574 0 ","4917411196130 0 ","7774917412077318 1 ","7774917411916362 1 ","7774917410731859 1 ","4917411601716 0 ","4917410632745 0 ","4917412421327 0 ","4917411719691 0 ","4917412489447 0 ","7774917411254207 1 ","7774917412983066 1 ","7774917412591916 1 ","7774917411501541 1 ","7774917411749518 1 ","7774917411121192 1 ","4917411616894 0 ","4917411686238 0 ","7774917412308223 1 ","4917410519853 0 ","7774917410975299 1 ","4917410363182 0 ","7774917410645781 1 ","4917410453721 0 ","4917411578234 0 ","4917412800637 0 ","4917411925351 0 ","4917410769755 0 ","4917411704390 0 ","7774917412867045 1 ","7774917412524750 1 ","4917412893153 0 ","4917410355975 0 ","7774917411330903 1 ","7774917410389955 1 ","4917412897805 0 ","7774917410409395 1 ","7774917412069924 1 ","4917412229000 0 ","4917412898828 0 ","4917412905889 0 ","4917411585210 0 ","7774917412692648 1 ","7774917412073403 1 ","7774917411923430 1 ","7774917411323761 1 ","7774917410370999 1 ","7774917412209577 1 ","7774917410262425 1 ","4917411944491 0 ","4917412562760 0 ","4917410223119 0 ","4917411012264 0 ","4917412729398 0 ","7774917412875077 1 ","4917412127751 0 "};


        try (IgniteClient client = Ignition.startClient(cfg)) {

            //For Initial Test
            //QueryParams p = new QueryParams(id,str[0],time,time);
            //WorkerClass workerClassTest = new WorkerClass(client,p);
            //workerClassTest.run();

            //Running with 16 threads
            ExecutorService executor = Executors.newFixedThreadPool(16);

            for(int i=0;i<str.length;i++){
                QueryParams params = new QueryParams(id,str[i],time,time);
                WorkerClass workerClass = new WorkerClass(client,params);
                executor.submit(workerClass);
            }
            while (true){} //Do not close main keep it running
        }
    }
}

